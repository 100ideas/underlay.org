# Migration `20201103001531-agent-unique-links`

This migration has been generated by Joel Gustafson at 11/2/2020, 7:15:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."agents.user_id_organization_id_unique"

ALTER INDEX "public"."agents_organization_id_unique" RENAME TO "agents.organization_id_unique"

ALTER INDEX "public"."agents_user_id_unique" RENAME TO "agents.user_id_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201029050444-add-is-public..20201103001531-agent-unique-links
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url = "***"
 }
 model Account {
     id                 String    @id @default(uuid())
@@ -83,17 +83,16 @@
 model Agent {
     id String @id @default(uuid())
     user               User?               @relation(fields: [userId], references: [id])
-    userId             String?             @map(name: "user_id")
+    userId             String?             @unique @map(name: "user_id")
     organization       Organization?       @relation(fields: [organizationId], references: [id])
-    organizationId     String?             @map(name: "organization_id")
+    organizationId     String?             @unique @map(name: "organization_id")
     schemas            Schema[]
     collections        Collection[]
     schemaVersions     SchemaVersion[]
     collectionVersions CollectionVersion[]
-    @@unique([userId, organizationId])
     @@map(name: "agents")
 }
 model Member {
```


